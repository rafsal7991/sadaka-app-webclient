import{a1 as v,a2 as h,a3 as g,a4 as x,a5 as C,a6 as I,a7 as y,r as w,a8 as T,a9 as L,Z as U,a as j,j as n,I as A,L as k,aa as R,ab as B,ac as d,ad as q,ae as z}from"./index.ef1be1b9.js";import{I as S}from"./InputGroup.49993b9a.js";import"./authApiSlice.54fce4ae.js";const D=v("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);class b{static async userLogin(r,s){var o,f;const e={grant_type:"password",username:r,password:(o=h.Buffer)==null?void 0:o.from(s).toString("base64")};console.log(e);const c=(f=h.Buffer)==null?void 0:f.from("advatech-portal:mauzo@Service").toString("base64");var a=[];for(var u in e){var p=encodeURIComponent(u),m=encodeURIComponent(e[u]);a.push(p+"="+m)}a=a.join("&");const i={"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8",Authorization:"Basic "+c,Accept:"application/json"};return await g.connectToAnotherSystem(x,"POST",a,i,void 0)}static async getUserDetail(r,s){try{const e={"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`,Accept:"application/json"};return await g.connectToAnotherSystem(`${C}?username=${r}`,"POST",{},e,void 0)}catch(e){return{success:!1,token:null,message:e.response.data||"something went wrong",status:e.response.status}}}static async getRoleFromServer(r,s){const e="/api/role-management/role",c={"Content-Type":"application/json",Authorization:`Bearer ${s}`,Accept:"application/json"};return await g.connectToAnotherSystem(`${e}`,"POST",{},c,r)}}const N=I({username:y().required("Username is Required"),password:y().required("Password is Required")}).required(),O=()=>{const[l,r]=w.exports.useState(!1),s=T(),{register:e,reset:c,formState:{errors:a},handleSubmit:u}=L({resolver:B(N),mode:"all"}),p=U(),m=async i=>{try{const t=await b.userLogin(i.username,i.password+"+7");if(t.status==200){const o=await b.getUserDetail(i.username,t.resultCurl);o.status==401&&(r(!1),d.error(o.message.MsgResp.StsDesc,{autoClose:2e3})),o.status==200?(s(q(t.resultCurl)),s(z(o.resultCurl)),p("/dashboard"),d.success("You have logged Successfully",{autoClose:2e3})):d.error("Inactive or invalid codeClassfication",{autoClose:2e3})}}catch(t){console.log(t),d.error(t.message,{autoClose:2e3})}};return w.exports.useState(!1),j("form",{onSubmit:u(m),className:"space-y-4 ",children:[n(S,{name:"username",type:"text",label:"username",placeholder:"username",prepend:n(D,{size:15}),defaultValue:"e-retail.admin",register:e,error:a.username,merged:!0,disabled:l}),n(S,{name:"password",label:"password",type:"password",placeholder:"password",prepend:n(A,{icon:"ph:lock-simple"}),defaultValue:"Mauzo@654321#",register:e,error:a.password,merged:!0,disabled:l}),n("div",{className:"flex justify-between",children:n(k,{to:"/forgot-password",className:"text-sm text-gray-400 dark:text-gray-400 hover:text-[#13317d] hover:underline  ",children:"Forgot Password?"})}),n(R,{type:"submit",text:"Sign in",className:"btn btn-primary block w-full text-center bg-[#13317d] hover:bg-[#13317d]/10 ",isLoading:l})]})};export{O as L};
